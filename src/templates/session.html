{% extends "base.html" %}

{% block scripts %}
      function endSession() {
        var xhr = new XMLHttpRequest();

        xhr.onreadystatechange = function() {
          if (xhr.readyState === 4) {
            var id = xhr.response
            window.location = "/sessions";
          }
        }

        xhr.open('PUT', '/sessions/{{id}}', true);
        xhr.send();
      }

      function doReload() {
        console.log("Reloading!")
        window.location.reload()
      }

      function reload() {
        // TODO: Do this only when new entries arrive?
        console.log("Waiting for reload")
        setTimeout(doReload, 1000)
      }

      window.onload = reload
{% endblock %}

{% block content %}
    <h1 style="text-align: center;">{{description}}</h1>
    <button onclick="endSession()" class="btn btn-danger btn-lg" style="position:absolute; top: 6rem; left: 1rem">
      End session
    </button>
  <div class="container">
    <div class="row">
      <div class="col">
        <ul id="session" class="list-group row" style="margin-top: 1rem;">
        {% for user in users %}
            <li class="list-group-item col-4">{{user.username}}</li>
        {% endfor %}
        </ul>
        <h1 class="col-3 offset-8" style="position: absolute; text-align: right; top: 20rem; font-size: 12rem; color: #FF851B;">{{fill}}%</h1>
      </div>
    </div>
  </div>
{% endblock %}
